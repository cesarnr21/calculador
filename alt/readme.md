try a different approeach here, instead of writing a c++ library, write similar python scripts like the ones in `test` and use cython instead and compare the speed between them
